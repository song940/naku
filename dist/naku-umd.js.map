{"version":3,"file":"naku-umd.js","sources":["../src/dom.js","../src/h.js","../src/reconciler.js","../src/render.js","../src/app.js"],"sourcesContent":["\nexport const createElement = (tagName, props, children) => {\n  const { style = {}, dataset = {}, ..._p } = props;\n  const e = document.createElement(tagName);\n  Object.entries(_p).map(([k, v]) => (e[k] = v));\n  Object.entries(style).map(([k, v]) => (e.style[k] = v));\n  Object.entries(dataset).map(([k, v]) => (e.dataset[k] = v));\n  children.map(child => e.append(child()));\n  return e;\n};","import { createElement } from './dom';\n\nconst flattern = arr => [].concat.apply([], arr);\n\nexport const h = (tagName, props = {}, ...c) => {\n  const children = flattern(c).filter(Boolean);\n  const render = ((element) => () => {\n    if (element) return element;\n    return (element = createElement(tagName, props, children))\n  })();\n  return Object.assign(render, { tagName, props, children })\n};\n\nexport const div = (props, children) => {\n  return h('div', props, children);\n};\n\nexport const h1 = (props, children) => {\n  return h('h1', props, children);\n};\n\nexport const span = (props, children) => {\n  return h('span', props, children);\n};\n\nexport const strong = (props, children) => {\n  return h('strong', props, children);\n};","\nconst longZip = (a1, a2) => {\n  const max = a1.length > a2.length ? a1 : a2;\n  return max.map((_, i) => [a1[i], a2[i]]);\n};\n\nexport const patchProps = (prev, next) => {\n  const e = prev()\n  const { style: pStyle = {}, dataset: pData = {}, ...pProps } = prev.props\n  const { style: nStyle = {}, dataset: nData = {}, ...nProps } = next.props\n  Object.entries(pProps).map(([k]) => nProps[k] === undefined && (e[k] = undefined))\n  Object.entries(nProps).map(([k, v]) => pProps[k] !== v && (e[k] = v))\n  Object.entries(pStyle).map(([k]) => nStyle[k] === undefined && e.style.removeProperty(k))\n  Object.entries(nStyle).map(([k, v]) => pStyle[k] !== v && (e.style[k] = v))\n  Object.entries(pData).map(([k]) => nData[k] === undefined && Reflect.deleteProperty(e.dataset, k))\n  Object.entries(nData).map(([k, v]) => pData[k] !== v && (e.dataset[k] = v))\n}\n\nexport const reconcile = (prev, next) => {\n  patchProps(prev, next);\n  const element = prev();\n  const children = longZip(prev.children, next.children).map(([p, n]) =>\n    p && !n ? p().remove()\n      : !p && n ? (element.append(n()), n)\n      : p.tagName !== n.tagName ? (p().replaceWith(n()), n)\n      : reconcile(p, n)\n  ).filter(Boolean);\n  return Object.assign(prev, { props: next.props, children })\n};","import { reconcile } from './reconciler';\n\nconst realNode = (element, props = {}, ...children) => {\n  return Object.assign(() => element, {\n    tagName: element.tagName, props, children: children.filter(Boolean)\n  });\n};\n\nexport const createMountPoint = root => {\n  let prev = realNode(root);\n  return (...children) =>\n    (prev = reconcile(prev, realNode(root, {}, ...children)));\n};\n","import { createMountPoint } from './render';\n\nexport const app = ctx => {\n  const dom = document.querySelector(ctx.node);\n  const mount = createMountPoint(dom);\n  const update = () => mount(ctx.render());\n  Object.assign(ctx, {\n    setState(state) {\n      Object.assign(this.state, state);\n      return update();\n    }\n  });\n  ctx.onLoad && ctx.onLoad();\n  return update();\n};"],"names":[],"mappings":"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"}