{"version":3,"file":"tinyact-esm.js","sources":["../src/dom.js","../src/h.js","../src/reconciler.js","../src/render.js","../src/app.js"],"sourcesContent":["\nexport const createElement = (tagName, props, children) => {\n  const { style = {}, dataset = {}, ..._p } = props;\n  const e = document.createElement(tagName);\n  Object.entries(_p).map(([k, v]) => (e[k] = v));\n  Object.entries(style).map(([k, v]) => (e.style[k] = v));\n  Object.entries(dataset).map(([k, v]) => (e.dataset[k] = v));\n  children.map(child => e.append(child()));\n  return e;\n};","import { createElement } from './dom';\n\nconst flattern = arr => [].concat.apply([], arr);\nexport default (tagName, props = {}, ...c) => {\n  const children = flattern(c).filter(Boolean);\n  const render = ((element) => () => {\n    if (element) return element;\n    return (element = createElement(tagName, props, children))\n  })();\n  return Object.assign(render, { tagName, props, children })\n};","\nconst longZip = (a1, a2) => {\n  const max = a1.length > a2.length ? a1 : a2;\n  return max.map((_, i) => [a1[i], a2[i]]);\n};\n\nexport const patchProps = (prev, next) => {\n  const e = prev()\n  const { style: pStyle = {}, dataset: pData = {}, ...pProps } = prev.props\n  const { style: nStyle = {}, dataset: nData = {}, ...nProps } = next.props\n  Object.entries(pProps).map(([k]) => nProps[k] === undefined && (e[k] = undefined))\n  Object.entries(nProps).map(([k, v]) => pProps[k] !== v && (e[k] = v))\n  Object.entries(pStyle).map(([k]) => nStyle[k] === undefined && e.style.removeProperty(k))\n  Object.entries(nStyle).map(([k, v]) => pStyle[k] !== v && (e.style[k] = v))\n  Object.entries(pData).map(([k]) => nData[k] === undefined && Reflect.deleteProperty(e.dataset, k))\n  Object.entries(nData).map(([k, v]) => pData[k] !== v && (e.dataset[k] = v))\n}\n\nexport const reconcile = (prev, next) => {\n  patchProps(prev, next);\n  const element = prev();\n  const children = longZip(prev.children, next.children).map(([p, n]) =>\n    p && !n ? p().remove()\n      : !p && n ? (element.append(n()), n)\n      : p.tagName !== n.tagName ? (p().replaceWith(n()), n)\n      : reconcile(p, n)\n  ).filter(Boolean);\n  return Object.assign(prev, { props: next.props, children })\n};","import { reconcile } from './reconciler';\n\nconst realNode = (element, props = {}, ...children) => {\n  return Object.assign(() => element, {\n    tagName: element.tagName, props, children: children.filter(Boolean)\n  });\n};\n\nexport const createMountPoint = root => {\n  let prev = realNode(root);\n  return (...children) =>\n    (prev = reconcile(prev, realNode(root, {}, ...children)));\n};\n","import { createMountPoint } from './render';\n\nexport const app = ctx => {\n  const dom = document.querySelector(ctx.node);\n  const mount = createMountPoint(dom);\n  const update = () => mount(ctx.render());\n  Object.assign(ctx, {\n    setState(state) {\n      Object.assign(this.state, state);\n      return update();\n    }\n  });\n  return update();\n};"],"names":[],"mappings":"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"}